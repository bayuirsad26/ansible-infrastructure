# Fail2ban configuration
# Managed by Ansible - Do not edit manually

[DEFAULT]
# "ignoreip" can be an IP address, a CIDR mask or a DNS host
ignoreip = 127.0.0.1/8 ::1

# External command that will take an tagged arguments to ignore, e.g. <ip>
ignorecommand =

# "bantime" is the number of seconds that a host is banned.
bantime = {{ common_fail2ban_bantime }}

# A host is banned if it has generated "maxretry" during the last "findtime" seconds.
findtime = {{ common_fail2ban_findtime }}

# "maxretry" is the number of failures before a host get banned.
maxretry = {{ common_fail2ban_maxretry }}

# "backend" specifies the backend used to get files modification.
backend = auto

# Email settings
destemail = root@localhost
sendername = Fail2Ban
mta = sendmail

# Actions
action = %(action_)s

[sshd]
enabled = true
port = {{ common_ssh_port }}
filter = sshd
logpath = /var/log/auth.log
maxretry = {{ common_fail2ban_maxretry }}
bantime = {{ common_fail2ban_bantime }}

[sshd-ddos]
enabled = true
port = {{ common_ssh_port }}
filter = sshd-ddos
logpath = /var/log/auth.log
maxretry = 2
bantime = {{ common_fail2ban_bantime }}

[apache-auth]
enabled = false
port = http,https
filter = apache-auth
logpath = /var/log/apache2/*error.log
maxretry = 6

[apache-badbots]
enabled = false
port = http,https
filter = apache-badbots
logpath = /var/log/apache2/*access.log
bantime = 172800
maxretry = 1

[nginx-http-auth]
enabled = false
port = http,https
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 6

[postfix]
enabled = false
port = smtp,465,587
filter = postfix
logpath = /var/log/mail.log

[recidive]
enabled = true
filter = recidive
logpath = /var/log/fail2ban.log
action = iptables-allports[name=recidive,protocol=all]
bantime = 604800
findtime = 86400
maxretry = 5
