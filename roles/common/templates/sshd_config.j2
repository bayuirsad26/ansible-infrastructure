# SSH Daemon Configuration - Security Hardened
# Managed by Ansible - Do not edit manually

# Network
Port {{ common_ssh_port }}
AddressFamily any
ListenAddress 0.0.0.0
ListenAddress ::

# Protocol
Protocol 2

# Authentication
LoginGraceTime 2m
PermitRootLogin {{ 'no' if common_disable_root_login else 'yes' }}
StrictModes yes
MaxAuthTries 3
MaxSessions 5

# Public key authentication
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys

# Password authentication
PasswordAuthentication {{ 'no' if not common_ssh_password_auth else 'yes' }}
PermitEmptyPasswords no
ChallengeResponseAuthentication no

# Kerberos and GSSAPI
KerberosAuthentication no
GSSAPIAuthentication no

# Forwarding
AllowAgentForwarding yes
AllowTcpForwarding yes
X11Forwarding no
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes
ClientAliveInterval 300
ClientAliveCountMax 2

# Environment
AcceptEnv LANG LC_*
Subsystem sftp /usr/lib/openssh/sftp-server

# Security
UsePAM yes
UseDNS no
PermitTunnel no
Banner none
